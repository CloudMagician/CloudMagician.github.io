---
layout:	post
title:	"Lexical Analysis"
image:	''
date:	2019-05-01 20:31:28
tags:	
- Exam
description: 'My life for pass!'
categories:
- Compilation Principle
---

<script type="text/javascript" src="../MathJax/MathJax.js?config=default"></script>
# 词法分析器概述

* 功能：读源程序的符号序列，逐个拼出单词，并构造相应的内部表示，同时检查源程序中的词法错误。
* 单词：所谓单词是指语言中具有独立含义的最小的语义单位。
* Token：单词的内部表示。“程序语言的操作对象（只能）是该语言规定的各种数据。”编译程序是用某种程序语言书写的程序，其操作对象是一般程序中的各种语法单位。

# 正则表达式

## 基本概念

### 字母表
∑，元素的非空有穷集合。

### 符号串

#### 定义
由字母表中的符号组成的任何有穷序列：
1. 空符号串（用ε表示）是Σ上的符号串 
2. 若x是Σ上的符号串,a是Σ的元素,则xa是Σ上的符号串 
3. y是Σ上的符号串,当且仅当它可以由1和2导出

#### 符号串的连接
设x和y均是字母表∑上的符号串，它们的连接是把y的所有符号顺序接在x的符号之后所得到的符号串。 

#### 符号串的方幂
设x是字母表∑上的符号串，把x自身连接n次得到的符号串z，称作符号串x的n 次幂，记作 z=xn。

#### 前缀和后缀
设x是字母表上的符号串，x=yz，则y是x的前缀，z是x的后缀，特别是当z≠ε时，y是x的真前缀；y≠ε时，z是x的真后缀。

#### 子符号串
非空符号串 x ，删去它的前缀和后缀后所得到的符号串称为 x 的子符号串，简称子串。如果删去的前缀和后缀不同时为ε,则称该子串为真子串。

#### 符号串集合
若集合A中的所有元素都是某字母表上的符号串，则称A为该字母表上的符号串集合。

#### 符号串集合的乘积

设A、B 是两个符号串集合，AB表示A与B的乘积，则定义
$$
AB=\{xy|(x∈A)∧(y∈B)\} 
$$

#### 符号串集合的方幂

设A是符号串集合，则称Ai 是符号串集合 A的方幂，其中i 是非负整数。
$$
A^0={ε}, A^1=A,  A^2=AA, …, A^n=AA… A
$$

#### 符号串集合的正闭包

$$
A^+=A^1∪A^2∪A^3 …
$$



#### 符号串集合的星闭包

$$
A^*= A^0∪A^1∪A^2∪A^3 …
$$



## 理论

### 非形式化定义

- 基本正则表达式：∅，ε，a
- 正则表达式的运算：选择：x|y；连接：x·y；重复：x*。

### 正则表达式形式化定义

- 正则表达式中出现的所有符号构成的集合为该正则表达式的字母表，用Σ表示。 
- 则Σ上的正则表达式递归定义如下：

1. 1. ∅和ε是正则表达式；
   2. 对于任意符号a∈Σ，则a是正则表达式；
   3. 若r和s是正则表达式，则r|s，rs，r*都是正则表达式；
   4. 仅由有限次应用上述规则所构成的正则表达式称为Σ上的正则表达式。

### 正则集

- 给定∑为给定的字母表，则每个Σ上的正则表达式将定义Σ上的一个符号串集，称为它表示的正则集。用RΣ表示∑上的正则表达式，用L(RΣ)表示RΣ所表示的符号串集合，即函数L表示正则表达式到符号串集的映射。
- ∅是正则表达式即∅∈RΣ ，则有L(∅)={}。
- ε是正则表达式即ε∈RΣ ，则有L(ε)={ε}。

## 正则表达式在词法分析中的应用

### 扩充的正则表达式

- 一次或多次重复:  A+
- 任何符号:**“**·**”**在字母表中任何符号.
- 符号范围:  [0--9]   [a--z]  [A--Z]
- 不在给定范围内的符号: \[^ a]
- 可选: A?

### 描述能力的局限性

* 不能表示描述配对或嵌套的结构；
* 不能用于描述“重复（对称）”结构。

# 有限自动机

## 确定有限自动机

### 定义

一个确定有限自动机DFA为一个五元组(∑,S,f,s0,Z)，其中：

* ∑是有穷字母表，每个元素称为一个输入字符；
* S是一个有穷集，它的每个元素称为一个状态；
* f是在 S◊∑→S上的单值转换函数；
* s0∈ S是唯一的一个初始状态；
* Z⊆S，是终止状态集，又称为接受状态集。

### 两种表示方式

#### 状态转换图

结点表示状态，转换边表示转换函数，边的箭头方向指向转换函数中定义的转换方向。标识出初始状态和终止状态。

#### 状态转换矩阵

可用二维数组描述。标识出初始状态和终止状态。若DFA中有 f (SI, a)=SJ，则：Trans (SI，a)＝ SJ

### DFA接受的字符串

对于∑*中的任何字符串t,若存在一条从初始结点到某一终止结点的路径，且这条路上所有弧的标记符连接成的字符串等于t,则称t为DFA M所接受（识别）的字符串。DFA M 所能接受的字符串的全体记为L(M)称为M所能接受（识别）的语言。

### DFA的确定性

- 初始状态唯一。
- 转换函数f:S◊∑→S是一个单值函数，也就是说，对任何状态s∈S,和输入符号 a∈∑, f(s,a) 唯一地确定了下一个状态。即转换函数至多确定一个状态。
- 没有空边，即不接受任何输入就进行状态转换（没有输入为ε，有时用λ表示的边）。

## 非确定有限自动机

### 定义

一个非确定有限自动机(NFA)A是一个五元组A=(∑,SS, f, S0,TS).其中：

* ∑是字母表

* SS是状态集

* f是转换函数
  $$
  f: SS × (∑∪\{ε\}) → 2^{SS}
  $$

* S0是初始状态集

* TS是终止状态集

### NFA接受的字符串

设A是一个NFA，A= (∑,SS, f, S0,TS)则定义L(A)为从任意初始状态到任意终止状态所接受的字符串集合。
$$
L(A)=\{β|s_0⇒βs’,s_0∈S_0,s’∈TS\}
$$

### 等价和NFA的确定化转换

- 自动机等价：设A1和A2是同一个字母表上的自动机，如果有L(A1)=L(A2)，则称A1和A2等价。

- NFA到DFA的转换（确定化）：

  定理：对于每一个非确定自动机A，存在一个确定自动机A’，使得L(A)=L(A’)。

#### 子集法

已知 NFA: A=(∑, S, f, S0, Z)

构造 DFA: A’=(∑, S’, f’, S0’, Z’)

1. 令A’的初始状态为S0’=[S1,S2,…Sk],其中S1…Sk是A的全部初始状态。
2. 若X=[S1,…,Sm]是A’的一个状态，a∈∑则定义f’(X,a)=f(S1,a)∪f(S2,a)…∪f(Sm,a)=Q，将Q加入S’，重复该过程，直到S’收敛。
3. 若Y=[S1,…,Sn]是A’的一个状态,且存在一个Si是A的终止状态，则令Y为A’的终止状态。

#### 带空边的NFA的确定化

* 设I是NFA的状态集的子集，则I的ε闭包为：
  $$
  ε\_CLOSURE(I)=I∪\{q|f(p, ε)=q, p∈ε\_CLOSURE(I)\}
  $$

* 设I是NFA状态集的子集，则
  $$
  I_a=ε\_CLOSURE(J)，J=\{q|f(p,a)=q, p∈I\}
  $$

* 修改后的子集法：

  已知 A：NFA, 构造 A**’**：DFA

  1. 令A’的初始状态为I0’=ε_CLOSURE({S1,S2,…Sk}),其中S1…Sk是A的全部初始状态。
  2. 若I={S1,…,Sm}是A’的一个状态，a∈∑则定义f’(I, a)=Ia将Ia加入S’，重复该过程，直到S’收敛。
  3. 若I’={S1,…,Sn}是A’的一个状态,且存在一个Si是A的终止状态，则令I’为A’的终止状态。

## DFA化简

- 状态等价：对DFA中的两个状态S1和S2，如果将它们看作是初始状态，所接受的符号串相同，则定义S1和S2是等价的。
- 无关状态：从有限自动机的开始状态开始，任何输入序列都不能到达的状态。
- 最小DFA：如果DFA中没有无关状态，也没有彼此等价的状态，则称该自动机是最小的。

### 状态分离法

1. 将DFA的所有状态K按终态和非终态划分成两个子集Z与K-Z，构成初始化分，记作：π={Z, K-Z}。
2. 设当前的划分π中已经含有m个子集: π={I1,I2,…,Im}对于每一个子集Ii={Si1,Si2,…,Sin}及每一个a∈∑，设Iin=f(Ii,a)={f(Si1,a),f(Si2,a),…,f(Sin,a)}若Iin中的状态分别落在π中p个不同的子集，则根据转移状态相同与否将Ii分为p个子集得到新的划分πnew。
3. 若πnew≠ π, 则将πnew作为π重复2，直到π不能划分。
4. 将最后所得到的划分π中的每个子集看成一个状态，对边作相应修改，确定开始状态和结束状态。

## 正则表达式与FA等价

定理：对任一确定有限自动机A，存在一正则表达式e,使得L(A)=L(e),反之亦然。

# 词法分析器的设计与实现

## 单词分类

* 标识符
* 常量
* 特殊符号

### 正则表达式描述

### 有限自动机描述

## 状态转换

### 矩阵法

* 特点：程序短小，但占用存储空间多。

### 图法

* 特点：程序长，但占用存储空间少。

## 特殊处理

### 保留字识别

* 统一识别：当作一般标识符统一识别；
* 单独识别：分开识别。

### 符合单词、数

* 复合单词的识别
* 数的转换

### 控制字符、注释

* 控制字符的处理
* 注释的处理

### 语义信息存储

* 直接在语义信息部分存储
* 设置标识符表和常量表

## 构造词法分析器步骤

1. 确定词法分析器的接口，即确定词法分析器是作为语法分析的一个子程序还是作为独立一遍。
2. 确定单词分类和Token结构。
3. 构造每一类单词的描述正则表达式并转换。正则表达式->NFA->DFA
4. 设计算法实现DFA。